import{ay as q,g as L,r as c,V as M,c as _,o as d,w as a,a as t,Q as S,e as R,b as e,an as w,f as Q,W as y,$ as C,t as s,Z as h,_ as F,a1 as v,a2 as T,a3 as N}from"./index-BCEHSGBj.js";import{Q as O}from"./QForm-Dun49YRB.js";import{c as V,Q as $,a as f,b as p}from"./QList-DquoUKNy.js";import{Q as U}from"./QBtnGroup-Ee1ZpqkP.js";import{Q as E}from"./QChip-Dhh2cHiC.js";import{Q as G}from"./QMarkupTable-CgVrH0X8.js";import{Q as H}from"./QPage-B9wyOFgf.js";import{h as B}from"./moment-C5S46NFB.js";const P={class:"row"},W={class:"col-6 col-md-2"},Z={class:"col-6 col-md-2"},j={class:"col-12 col-md-2 flex flex-center"},J={class:"col-12 col-md-12 q-pa-xs"},K={class:"row"},X={class:"col-12 col-md-4 q-pa-xs"},ee={class:"text-weight-bold"},le={class:"col-12 col-md-4 q-pa-xs"},te={class:"text-weight-bold"},ae={class:"col-12 col-md-4 q-pa-xs"},oe={class:"text-weight-bold"},se={key:1,class:"text-green text-bold text-center"},ne={key:2,class:"text-red text-bold text-center"},de={style:{"font-size":"10px"}},ie={class:"text-right"},re={class:"text-right"},ue={class:"text-right"},ce={class:"text-right"},fe={style:{"font-size":"10px",width:"80px","white-space":"normal","overflow-wrap":"break-word"}},we={__name:"Lista",setup(pe){const A=q(),{proxy:i}=L(),x=c(B().format("YYYY-MM-DD")),b=c(B().format("YYYY-MM-DD")),u=c([]),z=c([]),r=c(!1),g=c("");M(()=>{k()});function D(){u.value=z.value.filter(n=>n.nombre.toLowerCase().includes(g.value.toLowerCase()))}function I(n){i.$alert.dialogConfirm('<span style="color: blue;font-size: 20px;font-weight: bold">¿Desea confirmar la reserva?</span>').onOk(()=>{r.value=!0,i.$axios.post("reservasConfirmar",{id:n}).then(o=>{i.$socket.emit("reservas"),A.push("/reservas")}).catch(o=>{console.log(o)})})}function Y(n){i.$alert.dialogAnular('<span style="color: red;font-size: 20px;font-weight: bold">¿Desea anular la reserva?</span>').onOk(()=>{r.value=!0,i.$axios.post("reservasAnular",{id:n}).then(o=>{i.$socket.emit("reservas"),k()}).catch(o=>{console.log(o)})})}function k(){r.value=!0,i.$axios.get("reservasAll",{params:{fechaInicio:x.value,fechaFin:b.value}}).then(n=>{u.value=n.data,z.value=n.data}).catch(n=>{console.log(n)}).finally(()=>{r.value=!1})}return(n,o)=>(d(),_(H,{class:"q-pa-xs"},{default:a(()=>[t(S,{flat:"",bordered:""},{default:a(()=>[t(R,{class:"q-pa-xs"},{default:a(()=>[t(O,{onSubmit:k},{default:a(()=>[e("div",P,[e("div",W,[t(w,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=l=>x.value=l),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",Z,[t(w,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=l=>b.value=l),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",j,[t(Q,{label:"Buscar",color:"primary",type:"submit",icon:"search","no-caps":"",loading:r.value},null,8,["loading"])]),e("div",J,[t(w,{modelValue:g.value,"onUpdate:modelValue":[o[2]||(o[2]=l=>g.value=l),D],label:"Filtro",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e("div",K,[e("div",X,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"indigo","text-color":"white",icon:"event"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",ee,s(u.value.length)+" reservas ",1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[3]||(o[3]=[h(" Cantida de reservas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),e("div",le,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"green","text-color":"white",icon:"attach_money"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",te," Bs "+s(u.value.filter(l=>l.estado!=="Cancelado").reduce((l,m)=>l+parseFloat(m.total),0).toFixed(2)),1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[4]||(o[4]=[h(" Total de reservas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),e("div",ae,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"red","text-color":"white",icon:"cancel"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",oe," Bs "+s(u.value.filter(l=>l.estado==="Cancelado").reduce((l,m)=>l+parseFloat(m.total),0).toFixed(2)),1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[5]||(o[5]=[h(" Total de reservas canceladas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})])]),t(G,{"wrap-cells":"",dense:"",flat:"",bordered:""},{default:a(()=>[o[8]||(o[8]=e("thead",null,[e("tr",null,[e("th",null,"Opcion"),e("th",null,"Nombre"),e("th",null,"Sala"),e("th",null,"Fecha"),e("th",null,"Hora"),e("th",null,"Total"),e("th",null,"Adelanto"),e("th",null,"Saldo"),e("th",null,"Estado"),e("th",null,"Observaciones"),e("th",null,"Usuario")])],-1)),e("tbody",null,[(d(!0),v(T,null,N(u.value,l=>(d(),v("tr",{key:l.id},[e("td",null,[l.estado==="Reservado"?(d(),_(U,{key:0},{default:a(()=>[t(Q,{dense:"",label:"Anular",color:"red",icon:"delete","no-caps":"",onClick:m=>Y(l.id),size:"10px",loading:r.value},null,8,["onClick","loading"]),t(Q,{dense:"",label:"Confirmar",color:"blue",icon:"check","no-caps":"",onClick:m=>I(l.id),size:"10px",loading:r.value},null,8,["onClick","loading"])]),_:2},1024)):l.estado==="Finalizado"?(d(),v("div",se," Finalizado ")):(d(),v("div",ne,[o[6]||(o[6]=h(" Anulado ")),o[7]||(o[7]=e("br",null,null,-1)),e("div",de,s(l.user_cancelado?.name),1)]))]),e("td",null,s(l.nombre),1),e("td",null,s(l.sala),1),e("td",null,s(l.fecha),1),e("td",ie,s(l.horario),1),e("td",re,s(l.total),1),e("td",ue,s(l.adelanto),1),e("td",ce,s(l.total-l.adelanto),1),e("td",null,[t(E,{color:l.color,dense:"",size:"10px"},{default:a(()=>[h(s(l.estado),1)]),_:2},1032,["color"])]),e("td",null,s(l.observaciones),1),e("td",null,[e("div",fe,s(l.user?.name),1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{we as default};
