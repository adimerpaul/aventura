import{aA as L,g as M,r as p,l as T,c as f,o as d,w as a,a as t,Q as R,e as N,b as e,ap as F,f as x,Z as Q,a2 as y,t as n,a0 as h,a1 as C,a4 as v,a5 as O,a6 as U}from"./index-CA1MPuH5.js";import{Q as E}from"./QForm-IUpnMKCy.js";import{c as z,Q as V,a as m,b as _}from"./QList-Cv5DZRpc.js";import{Q as D}from"./QBtnGroup-CY0gC_YU.js";import{Q as H}from"./QChip-B5BDSPn6.js";import{Q as G}from"./QMarkupTable-BBGNlyfr.js";import{Q as P}from"./QPage-CK3pvUhf.js";import{h as Y}from"./moment-C5S46NFB.js";const Z={class:"row"},j={class:"col-6 col-md-2"},J={class:"col-6 col-md-2"},K={class:"col-12 col-md-2 flex flex-center"},W={class:"col-12 col-md-12 q-pa-xs"},X={class:"row"},ee={class:"col-12 col-md-4 q-pa-xs"},le={class:"text-weight-bold"},te={class:"col-12 col-md-4 q-pa-xs"},ae={class:"text-weight-bold"},oe={class:"col-12 col-md-4 q-pa-xs"},se={class:"text-weight-bold"},ne={key:2,class:"text-green text-bold text-center"},de={key:3,class:"text-red text-bold text-center"},ie={style:{"font-size":"10px"}},re={class:"text-right"},ce={class:"text-right"},ue={class:"text-right"},pe={class:"text-right"},fe={style:{"font-size":"10px",width:"80px","white-space":"normal","overflow-wrap":"break-word"}},Fe={__name:"Lista",setup(me){const I=L(),{proxy:r}=M(),b=p(Y().format("YYYY-MM-DD")),g=p(Y().format("YYYY-MM-DD")),u=p([]),$=p([]),i=p(!1),k=p("");T(()=>{w()});function S(){u.value=$.value.filter(s=>s.nombre.toLowerCase().includes(k.value.toLowerCase()))}function q(s){const o=parseFloat(s.adelanto).toFixed(2),l=parseFloat(s.total).toFixed(2),c=parseFloat(s.total-s.adelanto).toFixed(2);r.$alert.dialogConfirm('<span style="color: blue;font-size: 20px;font-weight: bold">¿Desea confirmar la reserva? <br> </span>Total: '+l+"<br>Adelanto: "+o+'<br><span style="color: red;font-size: 20px;font-weight: bold">Saldo: '+c+" Bs</span>").onOk(()=>{i.value=!0,r.$axios.post("reservasConfirmar",{id:s.id}).then(B=>{r.$socket.emit("reservas"),I.push("/reservas")}).catch(B=>{r.$alert.error(B.response.data.message,"Error"),i.value=!1})})}function A(s){r.$alert.dialogAnular('<span style="color: red;font-size: 20px;font-weight: bold">¿Desea anular la reserva?</span>').onOk(()=>{i.value=!0,r.$axios.post("reservasAnular",{id:s}).then(o=>{r.$socket.emit("reservas"),w()}).catch(o=>{console.log(o)})})}function w(){i.value=!0,r.$axios.get("reservasAll",{params:{fechaInicio:b.value,fechaFin:g.value}}).then(s=>{u.value=s.data,$.value=s.data}).catch(s=>{console.log(s)}).finally(()=>{i.value=!1})}return(s,o)=>(d(),f(P,{class:"q-pa-xs"},{default:a(()=>[t(R,{flat:"",bordered:""},{default:a(()=>[t(N,{class:"q-pa-xs"},{default:a(()=>[t(E,{onSubmit:w},{default:a(()=>[e("div",Z,[e("div",j,[t(F,{modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=l=>b.value=l),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",J,[t(F,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=l=>g.value=l),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",K,[t(x,{label:"Buscar",color:"primary",type:"submit",icon:"search","no-caps":"",loading:i.value},null,8,["loading"])]),e("div",W,[t(F,{modelValue:k.value,"onUpdate:modelValue":[o[2]||(o[2]=l=>k.value=l),S],label:"Filtro",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e("div",X,[e("div",ee,[t(z,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),f(V,{clickable:""},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(y,{color:"indigo","text-color":"white",icon:"event"})]),_:1}),t(m,null,{default:a(()=>[t(_,{lines:"1"},{default:a(()=>[e("span",le,n(u.value.length)+" reservas ",1)]),_:1}),t(_,{caption:"",lines:"2"},{default:a(()=>o[3]||(o[3]=[h(" Cantida de reservas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),e("div",te,[t(z,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),f(V,{clickable:""},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(y,{color:"green","text-color":"white",icon:"attach_money"})]),_:1}),t(m,null,{default:a(()=>[t(_,{lines:"1"},{default:a(()=>[e("span",ae," Bs "+n(u.value.filter(l=>l.estado!=="Cancelado").reduce((l,c)=>l+parseFloat(c.total),0).toFixed(2)),1)]),_:1}),t(_,{caption:"",lines:"2"},{default:a(()=>o[4]||(o[4]=[h(" Total de reservas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),e("div",oe,[t(z,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),f(V,{clickable:""},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(y,{color:"red","text-color":"white",icon:"cancel"})]),_:1}),t(m,null,{default:a(()=>[t(_,{lines:"1"},{default:a(()=>[e("span",se," Bs "+n(u.value.filter(l=>l.estado==="Cancelado").reduce((l,c)=>l+parseFloat(c.total),0).toFixed(2)),1)]),_:1}),t(_,{caption:"",lines:"2"},{default:a(()=>o[5]||(o[5]=[h(" Total de reservas canceladas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})])]),t(G,{"wrap-cells":"",dense:"",flat:"",bordered:""},{default:a(()=>[o[8]||(o[8]=e("thead",null,[e("tr",null,[e("th",null,"Opcion"),e("th",null,"Nombre"),e("th",null,"Sala"),e("th",null,"Fecha"),e("th",null,"Hora"),e("th",null,"Total"),e("th",null,"Adelanto"),e("th",null,"Saldo"),e("th",null,"Estado"),e("th",null,"Observaciones"),e("th",null,"Usuario")])],-1)),e("tbody",null,[(d(!0),v(O,null,U(u.value,l=>(d(),v("tr",{key:l.id},[e("td",null,[l.estado==="Reservado"?(d(),f(D,{key:0},{default:a(()=>[t(x,{dense:"",label:"Anular",color:"red",icon:"delete","no-caps":"",onClick:c=>A(l.id),size:"10px",loading:i.value},null,8,["onClick","loading"]),t(x,{dense:"",label:"Confirmar",color:"blue",icon:"check","no-caps":"",onClick:c=>q(l),size:"10px",loading:i.value},null,8,["onClick","loading"])]),_:2},1024)):l.estado==="Finalizado"&&l.directo?(d(),f(D,{key:1},{default:a(()=>[t(x,{dense:"",label:"Anular D",color:"red",icon:"delete","no-caps":"",onClick:c=>A(l.id),size:"10px",loading:i.value},null,8,["onClick","loading"])]),_:2},1024)):l.estado==="Finalizado"?(d(),v("div",ne," Finalizado ")):(d(),v("div",de,[o[6]||(o[6]=h(" Anulado ")),o[7]||(o[7]=e("br",null,null,-1)),e("div",ie,n(l.user_cancelado?.name),1)]))]),e("td",null,n(l.nombre),1),e("td",null,n(l.sala),1),e("td",null,n(s.$filters.dateDmYHis(l.fecha_creacion)),1),e("td",re,n(l.horario),1),e("td",ce,n(l.total),1),e("td",ue,n(l.adelanto),1),e("td",pe,n(l.total-l.adelanto),1),e("td",null,[t(H,{color:l.color,dense:"",size:"10px"},{default:a(()=>[h(n(l.estado),1)]),_:2},1032,["color"])]),e("td",null,n(l.observaciones),1),e("td",null,[e("div",fe,n(l.user?.username),1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Fe as default};
