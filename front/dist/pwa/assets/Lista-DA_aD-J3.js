import{aA as q,g as L,r as p,l as M,c as _,o as d,w as a,a as t,Q as T,e as R,b as e,ap as w,f as F,Z as Q,a2 as y,t as n,a0 as h,a1 as C,a4 as v,a5 as N,a6 as O}from"./index-gHp625-a.js";import{Q as U}from"./QForm-DX3Dsrq9.js";import{c as V,Q as $,a as f,b as m}from"./QList-BC2TOCZy.js";import{Q as E}from"./QBtnGroup-Wzqedqmh.js";import{Q as H}from"./QChip-Bc5I0Kor.js";import{Q as G}from"./QMarkupTable-BeLlV9km.js";import{Q as P}from"./QPage-CmNNLiaB.js";import{h as B}from"./moment-C5S46NFB.js";const Z={class:"row"},j={class:"col-6 col-md-2"},J={class:"col-6 col-md-2"},K={class:"col-12 col-md-2 flex flex-center"},W={class:"col-12 col-md-12 q-pa-xs"},X={class:"row"},ee={class:"col-12 col-md-4 q-pa-xs"},le={class:"text-weight-bold"},te={class:"col-12 col-md-4 q-pa-xs"},ae={class:"text-weight-bold"},oe={class:"col-12 col-md-4 q-pa-xs"},se={class:"text-weight-bold"},ne={key:1,class:"text-green text-bold text-center"},de={key:2,class:"text-red text-bold text-center"},ie={style:{"font-size":"10px"}},re={class:"text-right"},ce={class:"text-right"},ue={class:"text-right"},pe={class:"text-right"},fe={style:{"font-size":"10px",width:"80px","white-space":"normal","overflow-wrap":"break-word"}},Fe={__name:"Lista",setup(me){const D=q(),{proxy:i}=L(),x=p(B().format("YYYY-MM-DD")),b=p(B().format("YYYY-MM-DD")),u=p([]),z=p([]),r=p(!1),g=p("");M(()=>{k()});function Y(){u.value=z.value.filter(s=>s.nombre.toLowerCase().includes(g.value.toLowerCase()))}function I(s){const o=parseFloat(s.adelanto).toFixed(2),l=parseFloat(s.total).toFixed(2),c=parseFloat(s.total-s.adelanto).toFixed(2);i.$alert.dialogConfirm('<span style="color: blue;font-size: 20px;font-weight: bold">¿Desea confirmar la reserva? <br> </span>Total: '+l+"<br>Adelanto: "+o+'<br><span style="color: red;font-size: 20px;font-weight: bold">Saldo: '+c+" Bs</span>").onOk(()=>{r.value=!0,i.$axios.post("reservasConfirmar",{id:s.id}).then(A=>{i.$socket.emit("reservas"),D.push("/reservas")}).catch(A=>{i.$alert.error(A.response.data.message,"Error"),r.value=!1})})}function S(s){i.$alert.dialogAnular('<span style="color: red;font-size: 20px;font-weight: bold">¿Desea anular la reserva?</span>').onOk(()=>{r.value=!0,i.$axios.post("reservasAnular",{id:s}).then(o=>{i.$socket.emit("reservas"),k()}).catch(o=>{console.log(o)})})}function k(){r.value=!0,i.$axios.get("reservasAll",{params:{fechaInicio:x.value,fechaFin:b.value}}).then(s=>{u.value=s.data,z.value=s.data}).catch(s=>{console.log(s)}).finally(()=>{r.value=!1})}return(s,o)=>(d(),_(P,{class:"q-pa-xs"},{default:a(()=>[t(T,{flat:"",bordered:""},{default:a(()=>[t(R,{class:"q-pa-xs"},{default:a(()=>[t(U,{onSubmit:k},{default:a(()=>[e("div",Z,[e("div",j,[t(w,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=l=>x.value=l),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",J,[t(w,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=l=>b.value=l),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",K,[t(F,{label:"Buscar",color:"primary",type:"submit",icon:"search","no-caps":"",loading:r.value},null,8,["loading"])]),e("div",W,[t(w,{modelValue:g.value,"onUpdate:modelValue":[o[2]||(o[2]=l=>g.value=l),Y],label:"Filtro",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e("div",X,[e("div",ee,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(y,{color:"indigo","text-color":"white",icon:"event"})]),_:1}),t(f,null,{default:a(()=>[t(m,{lines:"1"},{default:a(()=>[e("span",le,n(u.value.length)+" reservas ",1)]),_:1}),t(m,{caption:"",lines:"2"},{default:a(()=>o[3]||(o[3]=[h(" Cantida de reservas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),e("div",te,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(y,{color:"green","text-color":"white",icon:"attach_money"})]),_:1}),t(f,null,{default:a(()=>[t(m,{lines:"1"},{default:a(()=>[e("span",ae," Bs "+n(u.value.filter(l=>l.estado!=="Cancelado").reduce((l,c)=>l+parseFloat(c.total),0).toFixed(2)),1)]),_:1}),t(m,{caption:"",lines:"2"},{default:a(()=>o[4]||(o[4]=[h(" Total de reservas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),e("div",oe,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((d(),_($,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(y,{color:"red","text-color":"white",icon:"cancel"})]),_:1}),t(f,null,{default:a(()=>[t(m,{lines:"1"},{default:a(()=>[e("span",se," Bs "+n(u.value.filter(l=>l.estado==="Cancelado").reduce((l,c)=>l+parseFloat(c.total),0).toFixed(2)),1)]),_:1}),t(m,{caption:"",lines:"2"},{default:a(()=>o[5]||(o[5]=[h(" Total de reservas canceladas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})])]),t(G,{"wrap-cells":"",dense:"",flat:"",bordered:""},{default:a(()=>[o[8]||(o[8]=e("thead",null,[e("tr",null,[e("th",null,"Opcion"),e("th",null,"Nombre"),e("th",null,"Sala"),e("th",null,"Fecha"),e("th",null,"Hora"),e("th",null,"Total"),e("th",null,"Adelanto"),e("th",null,"Saldo"),e("th",null,"Estado"),e("th",null,"Observaciones"),e("th",null,"Usuario")])],-1)),e("tbody",null,[(d(!0),v(N,null,O(u.value,l=>(d(),v("tr",{key:l.id},[e("td",null,[l.estado==="Reservado"?(d(),_(E,{key:0},{default:a(()=>[t(F,{dense:"",label:"Anular",color:"red",icon:"delete","no-caps":"",onClick:c=>S(l.id),size:"10px",loading:r.value},null,8,["onClick","loading"]),t(F,{dense:"",label:"Confirmar",color:"blue",icon:"check","no-caps":"",onClick:c=>I(l),size:"10px",loading:r.value},null,8,["onClick","loading"])]),_:2},1024)):l.estado==="Finalizado"?(d(),v("div",ne," Finalizado ")):(d(),v("div",de,[o[6]||(o[6]=h(" Anulado ")),o[7]||(o[7]=e("br",null,null,-1)),e("div",ie,n(l.user_cancelado?.name),1)]))]),e("td",null,n(l.nombre),1),e("td",null,n(l.sala),1),e("td",null,n(s.$filters.dateDmYHis(l.fecha_creacion)),1),e("td",re,n(l.horario),1),e("td",ce,n(l.total),1),e("td",ue,n(l.adelanto),1),e("td",pe,n(l.total-l.adelanto),1),e("td",null,[t(H,{color:l.color,dense:"",size:"10px"},{default:a(()=>[h(n(l.estado),1)]),_:2},1032,["color"])]),e("td",null,n(l.observaciones),1),e("td",null,[e("div",fe,n(l.user?.username),1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Fe as default};
