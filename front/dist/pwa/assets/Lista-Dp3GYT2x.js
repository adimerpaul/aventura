import{g as Y,r as u,V as L,c as _,o as d,w as a,a as t,Q as M,e as S,b as e,aB as w,f as Q,W as y,$ as C,t as s,Z as h,_ as F,a1 as x,a2 as q,a3 as T}from"./index-DEbtOr7C.js";import{Q as N}from"./QForm-BIWJhDDX.js";import{c as V,Q as B,a as f,b as p}from"./QList-3trESrqO.js";import{Q as O}from"./QBtnGroup-CsL8FtSP.js";import{Q as R}from"./QChip-CQY-KQ4p.js";import{Q as U}from"./QMarkupTable-rH2VDkqn.js";import{Q as E}from"./QPage-BHsL5-dn.js";import{h as z}from"./moment-C5S46NFB.js";const G={class:"row"},H={class:"col-6 col-md-2"},P={class:"col-6 col-md-2"},W={class:"col-12 col-md-2 flex flex-center"},Z={class:"col-12 col-md-4"},j={class:"row"},J={class:"col-12 col-md-4 q-pa-xs"},K={class:"text-weight-bold"},X={class:"col-12 col-md-4 q-pa-xs"},ee={class:"text-weight-bold"},le={class:"col-12 col-md-4 q-pa-xs"},te={class:"text-weight-bold"},ae={key:1,class:"text-green text-bold text-center"},oe={key:2,class:"text-red text-bold text-center"},se={style:{"font-size":"10px"}},ne={class:"text-right"},de={class:"text-right"},ie={class:"text-right"},re={class:"text-right"},ce={style:{"font-size":"10px",width:"80px","white-space":"normal","overflow-wrap":"break-word"}},ge={__name:"Lista",setup(ue){const{proxy:i}=Y(),b=u(z().format("YYYY-MM-DD")),g=u(z().format("YYYY-MM-DD")),c=u([]),$=u([]),r=u(!1),k=u("");L(()=>{v()});function A(){c.value=$.value.filter(n=>n.nombre.toLowerCase().includes(k.value.toLowerCase()))}function D(n){i.$alert.dialogConfirm('<span style="color: blue;font-size: 20px;font-weight: bold">¿Desea confirmar la reserva?</span>').onOk(()=>{r.value=!0,i.$axios.post("reservasConfirmar",{id:n}).then(o=>{i.$socket.emit("reservas"),v()}).catch(o=>{console.log(o)})})}function I(n){i.$alert.dialogAnular('<span style="color: red;font-size: 20px;font-weight: bold">¿Desea anular la reserva?</span>').onOk(()=>{r.value=!0,i.$axios.post("reservasAnular",{id:n}).then(o=>{i.$socket.emit("reservas"),v()}).catch(o=>{console.log(o)})})}function v(){r.value=!0,i.$axios.get("reservasAll",{params:{fechaInicio:b.value,fechaFin:g.value}}).then(n=>{c.value=n.data,$.value=n.data}).catch(n=>{console.log(n)}).finally(()=>{r.value=!1})}return(n,o)=>(d(),_(E,{class:"q-pa-xs"},{default:a(()=>[t(M,{flat:"",bordered:""},{default:a(()=>[t(S,{class:"q-pa-xs"},{default:a(()=>[t(N,{onSubmit:v},{default:a(()=>[e("div",G,[e("div",H,[t(w,{modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=l=>b.value=l),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",P,[t(w,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=l=>g.value=l),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",W,[t(Q,{label:"Buscar",color:"primary",type:"submit",icon:"search","no-caps":"",loading:r.value},null,8,["loading"])]),e("div",Z,[t(w,{modelValue:k.value,"onUpdate:modelValue":[o[2]||(o[2]=l=>k.value=l),A],label:"Filtro",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1}),e("div",j,[e("div",J,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_(B,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"indigo","text-color":"white",icon:"event"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",K,s(c.value.length)+" reservas ",1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[3]||(o[3]=[h(" Cantida de reservas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),e("div",X,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_(B,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"green","text-color":"white",icon:"attach_money"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",ee," Bs "+s(c.value.filter(l=>l.estado!=="Cancelado").reduce((l,m)=>l+parseFloat(m.total),0).toFixed(2)),1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[4]||(o[4]=[h(" Total de reservas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),e("div",le,[t(V,{bordered:"",padding:"",dense:""},{default:a(()=>[y((d(),_(B,{clickable:""},{default:a(()=>[t(f,{avatar:""},{default:a(()=>[t(C,{color:"red","text-color":"white",icon:"cancel"})]),_:1}),t(f,null,{default:a(()=>[t(p,{lines:"1"},{default:a(()=>[e("span",te," Bs "+s(c.value.filter(l=>l.estado==="Cancelado").reduce((l,m)=>l+parseFloat(m.total),0).toFixed(2)),1)]),_:1}),t(p,{caption:"",lines:"2"},{default:a(()=>o[5]||(o[5]=[h(" Total de reservas canceladas ")])),_:1})]),_:1})]),_:1})),[[F]])]),_:1})])]),t(U,{"wrap-cells":"",dense:"",flat:"",bordered:""},{default:a(()=>[o[8]||(o[8]=e("thead",null,[e("tr",null,[e("th",null,"Opcion"),e("th",null,"Nombre"),e("th",null,"Sala"),e("th",null,"Fecha"),e("th",null,"Hora"),e("th",null,"Total"),e("th",null,"Adelanto"),e("th",null,"Saldo"),e("th",null,"Estado"),e("th",null,"Observaciones"),e("th",null,"Usuario")])],-1)),e("tbody",null,[(d(!0),x(q,null,T(c.value,l=>(d(),x("tr",{key:l.id},[e("td",null,[l.estado==="Reservado"?(d(),_(O,{key:0},{default:a(()=>[t(Q,{dense:"",label:"Anular",color:"red",icon:"delete","no-caps":"",onClick:m=>I(l.id),size:"10px",loading:r.value},null,8,["onClick","loading"]),t(Q,{dense:"",label:"Confirmar",color:"blue",icon:"check","no-caps":"",onClick:m=>D(l.id),size:"10px",loading:r.value},null,8,["onClick","loading"])]),_:2},1024)):l.estado==="Finalizado"?(d(),x("div",ae," Finalizado ")):(d(),x("div",oe,[o[6]||(o[6]=h(" Anulado ")),o[7]||(o[7]=e("br",null,null,-1)),e("div",se,s(l.user_cancelado?.name),1)]))]),e("td",null,s(l.nombre),1),e("td",null,s(l.sala),1),e("td",null,s(l.fecha),1),e("td",ne,s(l.horario),1),e("td",de,s(l.total),1),e("td",ie,s(l.adelanto),1),e("td",re,s(l.total-l.adelanto),1),e("td",null,[t(R,{color:l.color,dense:"",size:"10px"},{default:a(()=>[h(s(l.estado),1)]),_:2},1032,["color"])]),e("td",null,s(l.observaciones),1),e("td",null,[e("div",ce,s(l.user?.name),1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{ge as default};
