import{g as Q,r as i,l as B,$ as F,c as V,o as u,w as n,a,Q as Y,e as f,b as t,ap as y,f as w,a4 as c,a5 as b,a6 as g,t as d}from"./index-CA1MPuH5.js";import{Q as C}from"./QForm-IUpnMKCy.js";import{Q as D}from"./QMarkupTable-BBGNlyfr.js";import{Q as I}from"./QPage-CK3pvUhf.js";import{h as k}from"./moment-C5S46NFB.js";const O={class:"row"},S={class:"col-12 col-md-2"},E={class:"col-12 col-md-2"},T={class:"col-12 col-md-2 flex flex-center"},U={class:"row"},W={class:"col-12"},A={__name:"Metricas",setup($){const{proxy:M}=Q(),m=i(k().startOf("isoWeek").format("YYYY-MM-DD")),p=i(k().endOf("isoWeek").format("YYYY-MM-DD")),h=i([]),_=i([]),v=i({chart:{height:350,type:"bar"},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:[]},yaxis:{title:{text:"Monto Total (Bs)"}},fill:{opacity:1},tooltip:{y:{formatter:r=>`${r} Bs`}}});B(()=>{x()});function x(){M.$axios.get("/metricas",{params:{fechaInicio:m.value,fechaFin:p.value}}).then(r=>{h.value=r.data;const o=r.data.map(e=>e.fechaFormat),l={};r.data.forEach(e=>{e.cajas.forEach(s=>{l[s.user.name]||(l[s.user.name]=[]),l[s.user.name].push(s.monto_real)})}),_.value=Object.keys(l).map(e=>({name:e,data:l[e]})),v.value.xaxis.categories=o})}return(r,o)=>{const l=F("apexchart");return u(),V(I,{class:"q-pa-xs"},{default:n(()=>[a(Y,null,{default:n(()=>[a(f,null,{default:n(()=>[a(C,{onSubmit:x},{default:n(()=>[t("div",O,[t("div",S,[a(y,{dense:"",outlined:"",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),label:"Fecha Inicio",type:"date"},null,8,["modelValue"])]),t("div",E,[a(y,{dense:"",outlined:"",modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=e=>p.value=e),label:"Fecha Fin",type:"date"},null,8,["modelValue"])]),t("div",T,[a(w,{color:"primary",label:"Buscar",type:"submit",icon:"search","no-caps":""})])])]),_:1})]),_:1}),a(f,null,{default:n(()=>[t("div",U,[t("div",W,[a(l,{type:"bar",height:"350",options:v.value,series:_.value},null,8,["options","series"])])])]),_:1}),a(f,null,{default:n(()=>[a(D,{dense:"",flat:"",bordered:""},{default:n(()=>[o[2]||(o[2]=t("thead",null,[t("tr",null,[t("th",null,"Fecha"),t("th",null,"Total (Bs)"),t("th",null,"Usuarios y Montos")])],-1)),t("tbody",null,[(u(!0),c(b,null,g(h.value,e=>(u(),c("tr",{key:e.fecha},[t("td",null,d(e.fechaFormat),1),t("td",null,d(e.monto_total),1),t("td",null,[(u(!0),c(b,null,g(e.cajas,s=>(u(),c("div",{key:s.id},d(s.user.name)+" - "+d(s.monto_real)+" Bs ",1))),128))])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{A as default};
