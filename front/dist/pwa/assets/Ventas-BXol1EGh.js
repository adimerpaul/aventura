import{g as M,r,V as T,c as p,o as n,w as a,a as e,Q as I,e as Y,b as l,aW as A,aB as g,f as w,W as Q,$ as V,t as d,Z as k,_ as C,a1 as y,a2 as N,a3 as S}from"./index-DEbtOr7C.js";import{Q as U}from"./QForm-BIWJhDDX.js";import{c as F,Q as B,a as c,b as f}from"./QList-3trESrqO.js";import{Q as E}from"./QChip-CQY-KQ4p.js";import{Q as W}from"./QMarkupTable-rH2VDkqn.js";import{Q as z}from"./QPage-BHsL5-dn.js";import{h as $}from"./moment-C5S46NFB.js";const O={class:"row"},P={class:"col-6 col-md-2"},R={class:"col-6 col-md-2"},Z={class:"col-12 col-md-2 flex flex-center"},j={class:"col-12 col-md-4"},G={class:"col-12 col-md-2 text-right"},H={class:"row"},J={class:"col-12 col-md-4 q-pa-xs"},K={class:"text-weight-bold"},X={class:"col-12 col-md-4 q-pa-xs"},ee={class:"text-weight-bold"},le={class:"col-12 col-md-4 q-pa-xs"},ae={class:"text-weight-bold"},te={key:1},fe={__name:"Ventas",setup(oe){const{proxy:v}=M(),h=r($().format("YYYY-MM-DD")),b=r($().format("YYYY-MM-DD")),i=r([]),L=r([]),u=r(!1),m=r("");T(()=>{x()});function q(){i.value=L.value.filter(s=>s.nombre.toLowerCase().includes(m.value.toLowerCase())||s.user?.name.toLowerCase().includes(m.value.toLowerCase())||s.detalleText.toLowerCase().includes(m.value.toLowerCase()))}function D(s){v.$q.dialog({title:"Anular Venta",message:"¿Está seguro de anular la venta?",ok:"Sí",cancel:"No"}).onOk(()=>{u.value=!0,v.$axios.put(`/ventas/${s}/anular`).then(()=>{x()}).finally(()=>{u.value=!1})})}function x(){u.value=!0,v.$axios.get("/ventas",{params:{fechaInicio:h.value,fechaFin:b.value}}).then(s=>{i.value=s.data,L.value=s.data}).finally(()=>{u.value=!1})}return(s,o)=>(n(),p(z,{class:"q-pa-xs"},{default:a(()=>[e(I,{flat:"",bordered:""},{default:a(()=>[e(Y,{class:"q-pa-xs"},{default:a(()=>[e(U,{onSubmit:A(x,["prevent"])},{default:a(()=>[l("div",O,[l("div",P,[e(g,{modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=t=>h.value=t),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),l("div",R,[e(g,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=t=>b.value=t),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),l("div",Z,[e(w,{label:"Buscar",color:"primary",type:"submit",icon:"search","no-caps":"",loading:u.value},null,8,["loading"])]),l("div",j,[e(g,{modelValue:m.value,"onUpdate:modelValue":[o[2]||(o[2]=t=>m.value=t),q],label:"Filtro",outlined:"",dense:""},null,8,["modelValue"])]),l("div",G,[e(w,{label:"Venta",color:"positive",onClick:o[3]||(o[3]=t=>s.$router.push("/ventas/add")),"no-caps":"",icon:"add_circle_outline",loading:u.value},null,8,["loading"])])])]),_:1}),l("div",H,[l("div",J,[e(F,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((n(),p(B,{clickable:""},{default:a(()=>[e(c,{avatar:""},{default:a(()=>[e(V,{color:"indigo","text-color":"white",icon:"event"})]),_:1}),e(c,null,{default:a(()=>[e(f,{lines:"1"},{default:a(()=>[l("span",K,d(i.value.length)+" ventas ",1)]),_:1}),e(f,{caption:"",lines:"2"},{default:a(()=>o[4]||(o[4]=[k(" Cantida de ventas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),l("div",X,[e(F,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((n(),p(B,{clickable:""},{default:a(()=>[e(c,{avatar:""},{default:a(()=>[e(V,{color:"green","text-color":"white",icon:"attach_money"})]),_:1}),e(c,null,{default:a(()=>[e(f,{lines:"1"},{default:a(()=>[l("span",ee," Bs "+d(i.value.filter(t=>!t.anulada).reduce((t,_)=>t+parseFloat(_.total),0).toFixed(2)),1)]),_:1}),e(f,{caption:"",lines:"2"},{default:a(()=>o[5]||(o[5]=[k(" Total de reservas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})]),l("div",le,[e(F,{bordered:"",padding:"",dense:""},{default:a(()=>[Q((n(),p(B,{clickable:""},{default:a(()=>[e(c,{avatar:""},{default:a(()=>[e(V,{color:"red","text-color":"white",icon:"cancel"})]),_:1}),e(c,null,{default:a(()=>[e(f,{lines:"1"},{default:a(()=>[l("span",ae," Bs "+d(i.value.filter(t=>t.anulada).reduce((t,_)=>t+parseFloat(_.total),0).toFixed(2)),1)]),_:1}),e(f,{caption:"",lines:"2"},{default:a(()=>o[6]||(o[6]=[k(" Total de reservas canceladas ")])),_:1})]),_:1})]),_:1})),[[C]])]),_:1})])])]),_:1})]),_:1}),e(I,{flat:"",bordered:"",class:"q-mt-md"},{default:a(()=>[e(Y,null,{default:a(()=>[e(W,{"wrap-cells":"",dense:"",flat:"",bordered:""},{default:a(()=>[o[7]||(o[7]=l("thead",null,[l("tr",null,[l("th",null,"Acciones"),l("th",null,"Fecha"),l("th",null,"Total"),l("th",null,"Nombre Cliente"),l("th",null,"Usuario"),l("th",null,"Detalle")])],-1)),l("tbody",null,[(n(!0),y(N,null,S(i.value,t=>(n(),y("tr",{key:t.id},[l("td",null,[t.anulada?(n(),y("div",te,[e(E,{color:"red","text-color":"white",label:"Anulada"})])):(n(),p(w,{key:0,style:{width:"80px"},icon:"remove_circle_outline",color:"negative",dense:"",onClick:_=>D(t.id),label:"Anular","no-caps":"",size:"10px"},null,8,["onClick"]))]),l("td",null,d(t.fecha),1),l("td",null,d(t.total),1),l("td",null,d(t.nombre),1),l("td",null,d(t.user?.name),1),l("td",null,d(t.detalleText),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{fe as default};
